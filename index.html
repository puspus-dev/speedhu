<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SpeedHU</title>
<style>
body {
  font-family: 'Arial', sans-serif;
  background: #f9f9f9;
  text-align: center;
  padding: 50px 20px;
  color: #333;
}

h1 { margin-bottom: 40px; }

/* Kör alakú gomb */
#testBtn {
  width: 100px;
  height: 100px;
  border-radius: 50%;
  border: none;
  background: #4CAF50;
  color: white;
  font-size: 20px;
  font-weight: bold;
  cursor: pointer;
  margin-bottom: 40px;
  transition: 0.3s;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
}

#testBtn:hover { background: #45a049; }
#testBtn:active { transform: scale(0.95); }

/* Kör animáció a méréshez */
#circleContainer {
  position: relative;
  margin: 0 auto 30px auto;
  width: 200px;
  height: 200px;
}

#spinnerCircle {
  width: 100%;
  height: 100%;
  border: 12px solid #e0e0e0;
  border-top: 12px solid #4CAF50;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  box-shadow: 0 0 20px rgba(76,175,80,0.6);
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

#circleText {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 18px;
  font-weight: bold;
}

#result { margin-top: 20px; font-size: 18px; }

@media (max-width: 500px){
  #circleContainer { width: 150px; height: 150px; }
  #circleText { font-size: 16px; }
  #testBtn { width: 80px; height: 80px; font-size: 18px; }
}
</style>
</head>
<body>

<h1>SpeedHU - Internet sebességmérő</h1>
<button id="testBtn">Teszt!</button>

<div id="circleContainer">
  <div id="spinnerCircle"></div>
  <div id="circleText">0 ms<br>0 Mbps<br>0 Mbps</div>
</div>

<p id="result"></p>

<script>
// Ping mérés
async function measurePing() {
  const start = performance.now();
  try { await fetch("https://jsonplaceholder.typicode.com/posts/1", {cache:"no-store"}); } catch(e){}
  const end = performance.now();
  return Math.round(end - start);
}

// Letöltés
async function measureDownload() {
  const url = "https://upload.wikimedia.org/wikipedia/commons/3/3f/Fronalpstock_big.jpg";
  const start = performance.now();
  const response = await fetch(url, { cache: "no-store" });
  const blob = await response.blob();
  const end = performance.now();
  const duration = (end - start)/1000;
  const bits = blob.size*8;
  return (bits/duration/1024/1024).toFixed(2);
}

// Feltöltés (64 KB)
async function measureUpload() {
  const data = new Uint8Array(64 * 1024);
  const start = performance.now();
  try { await fetch("https://jsonplaceholder.typicode.com/posts",{method:"POST",body:data}); } catch(e){}
  const end = performance.now();
  const duration = (end - start)/1000;
  const bits = data.length*8;
  return (bits/duration/1024/1024).toFixed(2);
}

// Fő teszt függvény
async function runTest() {
  const circleText = document.getElementById("circleText");
  const result = document.getElementById("result");

  circleText.textContent = "Mérés...\n0 ms\n0 Mbps\n0 Mbps";
  result.textContent = "";

  const ping = await measurePing();
  circleText.textContent = `Ping: ${ping} ms\n0 Mbps\n0 Mbps`;

  const download = await measureDownload();
  circleText.textContent = `Ping: ${ping} ms\nLetöltés: ${download} Mbps\n0 Mbps`;

  const upload = await measureUpload();
  circleText.textContent = `Ping: ${ping} ms\nLetöltés: ${download} Mbps\nFeltöltés: ${upload} Mbps`;

  result.textContent = `Mérés kész!`;
}

document.getElementById("testBtn").addEventListener("click", runTest);
</script>

</body>
</html>
